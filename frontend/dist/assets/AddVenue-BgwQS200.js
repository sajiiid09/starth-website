import{q as G,r as d,U as W,ao as K,t as u,e as v,j as e,y as _,L as Y,B as h,$ as J,a2 as Q,d as X,n as Z,O as l,I as c,Q as k,W as A,X as U,Y as E,Z as m,T as ee,aj as z,b as ae,A as se,V as re,_ as te}from"./index-KrjukJeb.js";import{C as le,a as ie,b as ne,c as oe}from"./card-tLMu1Ov7.js";import{C as I}from"./checkbox-uGjIcrta.js";import{P as ce}from"./progress-gnpwNbNM.js";import{n as de}from"./Camera.es-CbxhcNz5.js";import{m as ue}from"./CurrencyDollar.es-CPzZPXmX.js";import{m as he}from"./FloppyDisk.es-BgK92nk8.js";import{s as R}from"./Upload.es-Dw-8j3Wc.js";import{R as D}from"./RoleGuard-DRkcvV5M.js";import{V as O}from"./VenuePortalLayout-DFmbwPeC.js";import"./Envelope.es-BErI3QgS.js";import"./Shield.es-C51nR2_i.js";const me=[{value:"conference_meeting",label:"Conference & Meeting Space"},{value:"event_hall_ballroom",label:"Event Hall & Ballroom"},{value:"gallery_museum",label:"Gallery & Museum"},{value:"rooftop_outdoor",label:"Rooftop & Outdoor Space"},{value:"restaurant_bar",label:"Restaurant & Bar"},{value:"hotel_banquet",label:"Hotel & Banquet Hall"},{value:"theater_auditorium",label:"Theater & Auditorium"},{value:"loft_studio_warehouse",label:"Loft, Studio & Warehouse"},{value:"university_campus",label:"University & Campus"}],ge=["WiFi","Parking","AV Equipment","Catering Kitchen","Bar Service","Dance Floor","Stage","Outdoor Space","Air Conditioning","Heating","Wheelchair Accessible","Coat Check","Security","Valet Parking","Piano","Sound System","Projector","Microphones","Lighting System"],pe=["wedding","corporate","conference","party","networking","gala","fundraiser","product launch","training","seminar","celebration"];function Pe(){const x=G(),[j,T]=d.useState(null),[b,B]=d.useState(null),[L,M]=d.useState(!0),[g,f]=d.useState(!1),[N,w]=d.useState(!1),[t,C]=d.useState(1),[s,p]=d.useState({name:"",category:"",description:"",tags:[],address:"",city:"",state:"",country:"US",postal_code:"",capacity_min:"",capacity_max:"",amenities:[],layouts:[],hero_photo_url:"",gallery_urls:[],base_rate:"",hourly_rate:"",cleaning_fee:"",security_deposit:"",website:""}),S=d.useCallback(async()=>{try{const a=await W.me();T(a);const r=await K.filter({owner_user_id:a.id,type:"venue_owner"});if(r.length>0)B(r[0]);else{u.error("Please complete your organization profile first."),x(v("VenueOrganization"));return}}catch(a){console.error("Error fetching data:",a),u.error("Error loading data. Please try again.")}M(!1)},[x]);d.useEffect(()=>{S()},[S]);const i=(a,r)=>{p(n=>({...n,[a]:r}))},F=(a,r)=>{p(n=>({...n,[a]:n[a].includes(r)?n[a].filter(o=>o!==r):[...n[a],r]}))},P=async(a,r=!1)=>{const n=a.target.files[0];if(n){if(n.size>5*1024*1024){u.error("File size must be less than 5MB");return}w(!0);try{const{file_url:o}=await se({file:n});r?i("hero_photo_url",o):p($=>({...$,gallery_urls:[...$.gallery_urls,o]})),u.success("Image uploaded successfully!")}catch(o){console.error("Error uploading image:",o),u.error("Failed to upload image. Please try again.")}w(!1)}},H=a=>{p(r=>({...r,gallery_urls:r.gallery_urls.filter((n,o)=>o!==a)}))},V=async(a=!1)=>{f(!0);try{const r={org_id:b.id,owner_id:j.id,name:s.name,category:s.category,description:s.description,tags:s.tags,hero_photo_url:s.hero_photo_url,gallery_urls:s.gallery_urls,capacity_min:s.capacity_min?parseInt(s.capacity_min):1,capacity_max:s.capacity_max?parseInt(s.capacity_max):100,amenities:s.amenities,layouts:s.layouts,address:s.address,city:s.city,state:s.state,country:s.country,postal_code:s.postal_code,website:s.website,rate_card_json:{base_rate:s.base_rate?parseFloat(s.base_rate):0,hourly_rate:s.hourly_rate?parseFloat(s.hourly_rate):0,cleaning_fee:s.cleaning_fee?parseFloat(s.cleaning_fee):0,security_deposit:s.security_deposit?parseFloat(s.security_deposit):0},status:a?"submitted":"draft"},n=await re.create(r);if(a){console.log("Attempting to send submission email...");try{const o=await te({to:"info@renzairegroup.com",from_name:"Strathwell Platform",subject:`New Venue Submission for Review: ${r.name}`,body:`
              <div style="font-family: sans-serif; line-height: 1.6;">
                <h2>New Venue Submission on Strathwell</h2>
                <p>A new venue, <strong>${r.name}</strong>, has been submitted for review.</p>
                <hr>
                <h3>Details:</h3>
                <ul>
                  <li><strong>Venue ID:</strong> ${n.id}</li>
                  <li><strong>Venue Name:</strong> ${r.name}</li>
                  <li><strong>Organization:</strong> ${b.name}</li>
                  <li><strong>Location:</strong> ${r.city}, ${r.state}</li>
                  <li><strong>Submitted By:</strong> ${j.full_name} (${j.email})</li>
                </ul>
                <p>Please log in to your admin dashboard to review, verify, and publish this listing.</p>
                <br>
                <p>Thank you,</p>
                <p>The Strathwell Team</p>
              </div>
            `});console.log("Email send result:",o),u.success("Venue submitted! A notification has been sent for review.")}catch(o){console.error("Failed to send review email:",o),u.warning("Venue submitted, but the review notification failed to send. Please check manually.")}}else u.success("Venue saved as draft!");x(v("VenueListings"))}catch(r){console.error("Error saving venue:",r),u.error("Failed to save venue. Please try again.")}f(!1)},y=a=>{switch(a){case 1:return s.name&&s.category&&s.description;case 2:return s.address&&s.city&&s.state;case 3:return s.capacity_min&&s.capacity_max;case 4:return!0;case 5:return s.base_rate;default:return!0}},q=t/5*100;return L?e.jsx(D,{requiredRole:"venue_owner",children:e.jsx(O,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(_,{className:"w-8 h-8 animate-spin text-gray-500"})})})}):e.jsx(D,{requiredRole:"venue_owner",children:e.jsx(O,{children:e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(Y,{to:v("VenueListings"),children:e.jsx(h,{variant:"ghost",size:"icon",children:e.jsx(J,{className:"w-5 h-5"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add New Venue"}),e.jsxs("p",{className:"text-gray-600",children:["Step ",t," of 5"]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx(ce,{value:q,className:"h-2"})}),e.jsxs(le,{className:"border-none shadow-lg",children:[e.jsx(ie,{children:e.jsxs(ne,{className:"flex items-center gap-2",children:[t===1&&e.jsx(Q,{className:"w-5 h-5 text-blue-600"}),t===2&&e.jsx(X,{className:"w-5 h-5 text-green-600"}),t===3&&e.jsx(Z,{className:"w-5 h-5 text-orange-600"}),t===4&&e.jsx(de,{className:"w-5 h-5 text-purple-600"}),t===5&&e.jsx(ue,{className:"w-5 h-5 text-red-600"}),t===1&&"Basic Information",t===2&&"Location Details",t===3&&"Capacity & Features",t===4&&"Photos",t===5&&"Pricing"]})}),e.jsxs(oe,{className:"space-y-6",children:[t===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",children:"Venue Name *"}),e.jsx(c,{id:"name",value:s.name,onChange:a=>i("name",a.target.value),placeholder:"Enter your venue name"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"category",children:"Venue Category *"}),e.jsxs(k,{value:s.category,onValueChange:a=>i("category",a),children:[e.jsx(A,{children:e.jsx(U,{placeholder:"Select venue category"})}),e.jsx(E,{children:me.map(a=>e.jsx(m,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"description",children:"Description *"}),e.jsx(ee,{id:"description",value:s.description,onChange:a=>i("description",a.target.value),placeholder:"Describe your venue, its unique features, and what makes it special...",rows:4})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Event Types (Select all that apply)"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mt-2",children:pe.map(a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{id:`tag-${a}`,checked:s.tags.includes(a),onCheckedChange:()=>F("tags",a)}),e.jsx(l,{htmlFor:`tag-${a}`,className:"capitalize cursor-pointer",children:a})]},a))})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"website",children:"Website (Optional)"}),e.jsx(c,{id:"website",type:"url",value:s.website,onChange:a=>i("website",a.target.value),placeholder:"https://yourvenuewebsite.com"})]})]}),t===2&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"address",children:"Street Address *"}),e.jsx(c,{id:"address",value:s.address,onChange:a=>i("address",a.target.value),placeholder:"123 Main Street"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"city",children:"City *"}),e.jsx(c,{id:"city",value:s.city,onChange:a=>i("city",a.target.value),placeholder:"San Francisco"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"state",children:"State *"}),e.jsx(c,{id:"state",value:s.state,onChange:a=>i("state",a.target.value),placeholder:"CA"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"country",children:"Country *"}),e.jsxs(k,{value:s.country,onValueChange:a=>i("country",a),children:[e.jsx(A,{children:e.jsx(U,{})}),e.jsxs(E,{children:[e.jsx(m,{value:"US",children:"United States"}),e.jsx(m,{value:"CA",children:"Canada"}),e.jsx(m,{value:"UK",children:"United Kingdom"}),e.jsx(m,{value:"AU",children:"Australia"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"postal_code",children:"Postal Code"}),e.jsx(c,{id:"postal_code",value:s.postal_code,onChange:a=>i("postal_code",a.target.value),placeholder:"94105"})]})]})]}),t===3&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"capacity_min",children:"Minimum Capacity *"}),e.jsx(c,{id:"capacity_min",type:"number",value:s.capacity_min,onChange:a=>i("capacity_min",a.target.value),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"capacity_max",children:"Maximum Capacity *"}),e.jsx(c,{id:"capacity_max",type:"number",value:s.capacity_max,onChange:a=>i("capacity_max",a.target.value),placeholder:"200"})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Amenities & Features"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mt-2",children:ge.map(a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{id:`amenity-${a}`,checked:s.amenities.includes(a),onCheckedChange:()=>F("amenities",a)}),e.jsx(l,{htmlFor:`amenity-${a}`,className:"cursor-pointer text-sm",children:a})]},a))})]})]}),t===4&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(l,{children:"Hero Photo"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Main photo that will represent your venue"}),s.hero_photo_url?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.hero_photo_url,alt:"Hero",className:"w-full h-48 object-cover rounded-lg"}),e.jsx(h,{variant:"destructive",size:"icon",className:"absolute top-2 right-2",onClick:()=>i("hero_photo_url",""),children:e.jsx(z,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:a=>P(a,!0),className:"hidden",id:"hero-upload",disabled:N}),e.jsxs("label",{htmlFor:"hero-upload",className:"cursor-pointer",children:[e.jsx(R,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Click to upload hero photo"}),e.jsx("p",{className:"text-sm text-gray-400",children:"PNG, JPG up to 5MB"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Gallery Photos (Optional)"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Additional photos of your venue"}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-4",children:s.gallery_urls.map((a,r)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a,alt:`Gallery ${r+1}`,className:"w-full h-24 object-cover rounded-lg"}),e.jsx(h,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6",onClick:()=>H(r),children:e.jsx(z,{className:"w-3 h-3"})})]},r))}),s.gallery_urls.length<10&&e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:a=>P(a,!1),className:"hidden",id:"gallery-upload",disabled:N}),e.jsxs("label",{htmlFor:"gallery-upload",className:"cursor-pointer",children:[e.jsx(R,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Add gallery photo"})]})]})]})]}),t===5&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"base_rate",children:"Base Rate (per event) *"}),e.jsx(c,{id:"base_rate",type:"number",value:s.base_rate,onChange:a=>i("base_rate",a.target.value),placeholder:"5000"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"hourly_rate",children:"Hourly Rate (Optional)"}),e.jsx(c,{id:"hourly_rate",type:"number",value:s.hourly_rate,onChange:a=>i("hourly_rate",a.target.value),placeholder:"250"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"cleaning_fee",children:"Cleaning Fee (Optional)"}),e.jsx(c,{id:"cleaning_fee",type:"number",value:s.cleaning_fee,onChange:a=>i("cleaning_fee",a.target.value),placeholder:"300"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"security_deposit",children:"Security Deposit (Optional)"}),e.jsx(c,{id:"security_deposit",type:"number",value:s.security_deposit,onChange:a=>i("security_deposit",a.target.value),placeholder:"1000"})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Pricing Tips"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• Research similar venues in your area for competitive pricing"}),e.jsx("li",{children:"• Consider offering package deals for longer events"}),e.jsx("li",{children:"• Security deposits typically range from $500-$2000"}),e.jsx("li",{children:"• You can always adjust pricing later in your dashboard"})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6 border-t",children:[e.jsx(h,{variant:"outline",onClick:()=>C(t-1),disabled:t===1,children:"Previous"}),e.jsx("div",{className:"flex gap-2",children:t<5?e.jsx(h,{onClick:()=>C(t+1),disabled:!y(t),className:"bg-blue-600 hover:bg-blue-700",children:"Next"}):e.jsxs(e.Fragment,{children:[e.jsxs(h,{variant:"outline",onClick:()=>V(!1),disabled:g||!y(t),children:[g?e.jsx(_,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(he,{className:"w-4 h-4 mr-2"}),"Save Draft"]}),e.jsxs(h,{onClick:()=>V(!0),disabled:g||!y(t),className:"bg-green-600 hover:bg-green-700",children:[g?e.jsx(_,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(ae,{className:"w-4 h-4 mr-2"}),"Submit for Review"]})]})})]})]})]})]})})})}export{Pe as default};
