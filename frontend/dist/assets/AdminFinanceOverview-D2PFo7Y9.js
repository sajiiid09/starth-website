import{j as e,B as n,L as c,at as m,a as h,bY as d}from"./index-KrjukJeb.js";import{C as t,c as r,a as p,b as j}from"./card-tLMu1Ov7.js";import{u as g}from"./useAdminQuery-gkE_Vin9.js";import{a as u}from"./adminService-C8aRWX_T.js";const o=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(s/100),N=s=>new Date(s).toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),y=s=>s.replace(/_/g," ").toLowerCase(),v=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:Array.from({length:4}).map((s,i)=>e.jsx(d,{className:"h-28 w-full"},i))}),e.jsx(d,{className:"h-80 w-full"})]}),k=()=>{const{data:s,isLoading:i,error:l,refetch:x}=g(()=>u.getFinanceOverview(),[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-brand-teal",children:"Finance"}),e.jsx("h1",{className:"mt-3 text-3xl font-semibold text-gray-900",children:"Finance overview"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Track held funds, payout release, and controlled payout risk."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{asChild:!0,variant:"outline",children:e.jsx(c,{to:"/admin/bookings",children:"Bookings"})}),e.jsx(n,{asChild:!0,variant:"outline",children:e.jsx(c,{to:"/admin/payouts",children:"Payout queue"})})]})]}),i&&e.jsx(v,{}),!i&&l&&e.jsx(t,{className:"border-red-200 bg-red-50",children:e.jsxs(r,{className:"p-4 text-sm text-red-700",children:[e.jsxs("p",{children:["Unable to load finance overview. ",l.message]}),e.jsx(n,{variant:"outline",className:"mt-3",onClick:()=>void x(),children:"Retry"})]})}),!i&&!l&&s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(t,{className:"border-none shadow-soft",children:e.jsxs(r,{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total held funds"}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-amber-700",children:o(s.totalHeldFundsCents)}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Funds not yet released to vendors."})]})}),e.jsx(t,{className:"border-none shadow-soft",children:e.jsxs(r,{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total paid out"}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-emerald-700",children:o(s.totalPaidOutCents)}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Released funds completed to vendors."})]})}),e.jsx(t,{className:"border-none shadow-soft",children:e.jsxs(r,{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pending payouts"}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-gray-900",children:s.pendingPayoutsCount}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Awaiting admin approval."})]})}),e.jsx(t,{className:"border-none shadow-soft",children:e.jsxs(r,{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Active this month"}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-gray-900",children:s.activeBookingsThisMonth}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Bookings currently active this month."})]})})]}),e.jsxs(t,{className:"border-none shadow-soft",children:[e.jsxs(p,{className:"flex-row items-center justify-between space-y-0",children:[e.jsx(j,{className:"text-lg",children:"Recent activity"}),e.jsx(n,{asChild:!0,variant:"ghost",size:"sm",children:e.jsxs(c,{to:"/admin/payouts",children:["Open payout queue",e.jsx(m,{className:"size-4"})]})})]}),e.jsx(r,{className:"space-y-3",children:s.recentActivity.length===0?e.jsx("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-6 text-sm text-gray-600",children:"No recent activity yet."}):s.recentActivity.map(a=>e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 rounded-xl border border-gray-100 bg-white p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:y(a.action)}),e.jsxs("p",{className:"text-xs text-gray-600",children:[a.actor," Â· ",a.resourceType," ",a.resourceId]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",children:a.resourceType}),e.jsx("span",{className:"text-xs text-gray-500",children:N(a.timestamp)})]})]},a.id))})]})]})]})};export{k as default};
