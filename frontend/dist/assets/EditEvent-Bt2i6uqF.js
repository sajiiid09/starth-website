import{q as T,r,a3 as x,j as e,y as I,L as F,e as h,B as c,$,Q as B,W as V,X as L,Y as A,Z as M,I as d,T as O,d as R,N as v,n as q,ah as b}from"./index-KrjukJeb.js";import{C as G,a as z,b as U,c as W}from"./card-tLMu1Ov7.js";import{C as p}from"./checkbox-uGjIcrta.js";import{P as j,a as f,b as N,C as _}from"./popover-BG0fWMNa.js";import{m as H}from"./CurrencyDollar.es-CPzZPXmX.js";import{f as y}from"./isSameMonth-Ccyd4klX.js";import"./en-US-B77o_Iq_.js";import"./differenceInCalendarMonths-DCHHw2al.js";const Q=[{value:"corporate",label:"Corporate Event",icon:"ðŸ¢"},{value:"wedding",label:"Wedding",icon:"ðŸ’’"},{value:"conference",label:"Conference",icon:"ðŸŽ¯"},{value:"product_launch",label:"Product Launch",icon:"ðŸš€"},{value:"networking",label:"Networking",icon:"ðŸ¤"},{value:"fundraiser",label:"Fundraiser",icon:"ðŸ’"},{value:"social",label:"Social Event",icon:"ðŸŽ‰"},{value:"other",label:"Other",icon:"ðŸ“…"}],X={corporate:["Team Building","Catering","AV Equipment","Facilitation","Transportation"],wedding:["Photography","Floral","Catering","Entertainment","Planning"],conference:["Speaker Management","Registration","AV & Streaming","Catering","Networking"],product_launch:["Marketing","Demo Setup","Media Coverage","Catering","Brand Activation"],networking:["Icebreakers","Catering","Name Badges","Follow-up","Venue Setup"],fundraiser:["Auction Management","Donation Processing","Entertainment","Catering","Marketing"],social:["Entertainment","Party Planning","Catering & Bar","Photography","Decorations"],other:["Custom Planning","Catering","AV Equipment","Photography","General Support"]},Y=["draft","planning","published","booked","completed","cancelled"];function re(){const C=T(),[a,o]=r.useState(null),[m,g]=r.useState(!1),[S,w]=r.useState(!0),[i,E]=r.useState(null),u=r.useCallback(async t=>{if(t){try{const s=await x.get(t);s&&o({...s,date_start:s.date_start?new Date(s.date_start):null,date_end:s.date_end?new Date(s.date_end):null,selected_categories:s.selected_categories||[],style_tags:s.style_tags||[]})}catch(s){console.error("Error loading event:",s)}w(!1)}},[]);r.useEffect(()=>{const s=new URLSearchParams(window.location.search).get("id");E(s),u(s)},[u]);const n=(t,s)=>{o(l=>({...l,[t]:s}))},k=t=>{o(s=>({...s,selected_categories:s.selected_categories.includes(t)?s.selected_categories.filter(l=>l!==t):[...s.selected_categories,t]}))},P=async()=>{var t,s;if(!(!a||!i)){g(!0);try{const l={...a,date_start:(t=a.date_start)==null?void 0:t.toISOString(),date_end:(s=a.date_end)==null?void 0:s.toISOString(),guest_count:a.guest_count?parseInt(a.guest_count):null,budget_target:a.budget_target?parseFloat(a.budget_target):null};await x.update(i,l),l.status==="published"&&l.eventbrite_enabled&&(await b.filter({event_id:i})).length===0&&await b.create({event_id:i,eb_org_id:"ORG123",eb_event_id:`EVT${Date.now()}`,eb_ticket_url:`https://www.eventbrite.com/e/${Date.now()}`,last_synced_at:new Date().toISOString()}),C(h("Events"))}catch(l){console.error("Error updating event:",l)}g(!1)}};if(S)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-gray-500"})});if(!a)return e.jsx("div",{className:"text-center p-8",children:"Event not found."});const D=a.event_type?X[a.event_type]||[]:[];return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx(F,{to:h("Events"),children:e.jsx(c,{variant:"ghost",size:"icon",children:e.jsx($,{className:"w-5 h-5"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Event"})]}),e.jsxs(G,{className:"border-none shadow-lg",children:[e.jsx(z,{children:e.jsx(U,{children:"Event Details"})}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs(B,{value:a.status,onValueChange:t=>n("status",t),children:[e.jsx(V,{children:e.jsx(L,{placeholder:"Select status"})}),e.jsx(A,{children:Y.map(t=>e.jsx(M,{value:t,className:"capitalize",children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Event Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Q.map(t=>e.jsxs("button",{onClick:()=>n("event_type",t.value),className:`p-4 rounded-lg border-2 text-left transition-all ${a.event_type===t.value?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:t.icon}),e.jsx("div",{className:"font-medium text-gray-900",children:t.label})]},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Name"}),e.jsx(d,{placeholder:"Enter your event name...",value:a.title,onChange:t=>n("title",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx(O,{placeholder:"Describe your event...",value:a.description,onChange:t=>n("description",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(d,{placeholder:"City, State",value:a.city,onChange:t=>n("city",t.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsxs(j,{children:[e.jsx(f,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:"w-full justify-start text-left",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),a.date_start?y(a.date_start,"PPP"):"Select date"]})}),e.jsx(N,{className:"w-auto p-0",children:e.jsx(_,{mode:"single",selected:a.date_start,onSelect:t=>n("date_start",t)})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsxs(j,{children:[e.jsx(f,{asChild:!0,children:e.jsxs(c,{variant:"outline",className:"w-full justify-start text-left",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),a.date_end?y(a.date_end,"PPP"):"Select date"]})}),e.jsx(N,{className:"w-auto p-0",children:e.jsx(_,{mode:"single",selected:a.date_end,onSelect:t=>n("date_end",t)})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guest Count"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(d,{type:"number",placeholder:"Expected guests",value:a.guest_count,onChange:t=>n("guest_count",t.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget Target"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(d,{type:"number",placeholder:"Total budget",value:a.budget_target,onChange:t=>n("budget_target",t.target.value),className:"pl-10"})]})]})]}),a.event_type&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Event Needs"}),e.jsx("div",{className:"space-y-2",children:D.map((t,s)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(p,{id:`category-${s}`,checked:a.selected_categories.includes(t),onCheckedChange:()=>k(t)}),e.jsx("label",{htmlFor:`category-${s}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t})]},s))})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(p,{id:"eventbrite",checked:a.eventbrite_enabled,onCheckedChange:t=>n("eventbrite_enabled",t)}),e.jsx("label",{htmlFor:"eventbrite",className:"text-sm font-medium text-gray-700",children:"Enable Eventbrite Ticketing"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"If status is 'Published', this will create/update an Eventbrite event."})]}),e.jsx("div",{className:"flex gap-3 pt-6",children:e.jsx(c,{onClick:P,disabled:m,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 text-lg font-semibold",children:m?"Saving...":"Save Changes"})})]})]})]})})}export{re as default};
