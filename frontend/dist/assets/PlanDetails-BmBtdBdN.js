import{r as l,G as N,j as e,y as I,L as V,e as L,B as r,$ as U,I as A,ai as G,aj as H,s as B,d as K,n as O,a as W,t as m,Q as X,W as Y,X as Z,Y as J,Z as M}from"./index-KrjukJeb.js";import{C as x,a as h,b as j,c as u}from"./card-tLMu1Ov7.js";import{n as ee}from"./Clock.es-CCh8QZyI.js";import{m as se}from"./CurrencyDollar.es-CPzZPXmX.js";import{m as ae}from"./FloppyDisk.es-BgK92nk8.js";import{a as te}from"./PencilSimple.es-BMiv362s.js";import{V as ne,a as le}from"./VendorCard-BX3yGp4b.js";import"./ArrowSquareOut.es-DnFjawrD.js";import"./ChatCircle.es-DeE-r4hZ.js";import"./Star.es-BgtEy1eT.js";const D=({value:a,onChange:c})=>{const i=[{value:"not_contacted",label:"Not Contacted",color:"bg-gray-100 text-gray-800"},{value:"contacted",label:"Contacted",color:"bg-blue-100 text-blue-800"},{value:"booked",label:"Booked",color:"bg-green-100 text-green-800"}],o=i.find(n=>n.value===a)||i[0];return e.jsxs(X,{value:a,onValueChange:c,children:[e.jsx(Y,{className:`w-40 border-none h-8 text-xs ${o.color}`,children:e.jsx(Z,{placeholder:"Set Status"})}),e.jsx(J,{children:i.map(n=>e.jsx(M,{value:n.value,children:n.label},n.value))})]})};function pe(){var E,_,$,T;const[a,c]=l.useState(null),[i,o]=l.useState(!0),[n,v]=l.useState(!1),[re,R]=l.useState(null),[F,p]=l.useState(!1),[g,f]=l.useState("");l.useEffect(()=>{const t=new URLSearchParams(window.location.search).get("id");t?(R(t),z(t)):o(!1)},[]);const z=async s=>{o(!0);try{const t=await N.get(s);c(t),f(t.title)}catch(t){console.error("Error fetching plan:",t)}o(!1)},b=(s,t,d)=>{const k={...a};k.recommendations_json[s][t].status=d,c(k)},Q=s=>{alert(`Quote requested for ${s.name}. (This would open a chat in a full app)`)},q=async()=>{if(a){v(!0);try{await N.update(a.id,{recommendations_json:a.recommendations_json}),m.success("Plan saved successfully!")}catch(s){console.error("Failed to save plan:",s),m.error("Failed to save plan")}v(!1)}},y=async()=>{if(!g.trim()){m.error("Plan name cannot be empty");return}try{await N.update(a.id,{title:g}),c({...a,title:g}),p(!1),m.success("Plan renamed successfully!")}catch(s){console.error("Failed to rename plan:",s),m.error("Failed to rename plan")}},w=()=>{f(a.title),p(!1)};if(i)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(I,{className:"w-8 h-8 animate-spin"})});if(!a)return e.jsx("div",{className:"text-center py-12",children:"Plan not found."});const{venues:S=[],vendors:C=[],suggested_categories:P=[]}=a.recommendations_json||{};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(V,{to:L("Dashboard"),children:e.jsx(r,{variant:"ghost",size:"icon",children:e.jsx(U,{className:"w-5 h-5"})})}),e.jsxs("div",{className:"flex-1",children:[F?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{value:g,onChange:s=>f(s.target.value),className:"text-2xl font-bold h-12",autoFocus:!0,onKeyDown:s=>{s.key==="Enter"&&y(),s.key==="Escape"&&w()}}),e.jsx(r,{size:"icon",variant:"ghost",onClick:y,children:e.jsx(G,{className:"w-5 h-5 text-green-600"})}),e.jsx(r,{size:"icon",variant:"ghost",onClick:w,children:e.jsx(H,{className:"w-5 h-5 text-red-600"})})]}):e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:a.title}),e.jsx(r,{size:"icon",variant:"ghost",onClick:()=>p(!0),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(te,{className:"w-4 h-4 text-gray-500"})})]}),e.jsx("p",{className:"text-gray-600",children:a.event_date?new Date(a.event_date).toLocaleDateString():"No date set"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{onClick:q,disabled:n,variant:"outline",children:[n?e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(ae,{className:"w-4 h-4 mr-2"}),"Save Changes"]}),e.jsx(V,{to:L("EventBuilder")+`?planId=${a.id}`,children:e.jsxs(r,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Create Event from Plan"]})})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs(x,{className:"border-none shadow-lg",children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-blue-600"})," Recommended Venues"]})}),e.jsx(u,{className:"grid gap-4",children:S.length>0?S.map((s,t)=>e.jsxs("div",{children:[e.jsx(ne,{venue:s,onRequestQuote:Q}),e.jsx("div",{className:"flex justify-end -mt-4 mr-4",children:e.jsx(D,{value:s.status,onChange:d=>b("venues",t,d)})})]},t)):e.jsx("p",{className:"text-gray-500",children:"No venues recommended."})})]}),e.jsxs(x,{className:"border-none shadow-lg",children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5 text-green-600"})," Recommended Vendors"]})}),e.jsx(u,{className:"grid gap-4",children:C.length>0?C.map((s,t)=>e.jsxs("div",{children:[e.jsx(le,{vendor:s}),e.jsx("div",{className:"flex justify-end -mt-4 mr-4",children:e.jsx(D,{value:s.status,onChange:d=>b("vendors",t,d)})})]},t)):e.jsx("p",{className:"text-gray-500",children:"No vendors recommended."})})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs(x,{className:"border-none shadow-lg",children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-yellow-500"})," AI Suggestions"]})}),e.jsxs(u,{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Suggested Categories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:P.length>0?P.map((s,t)=>e.jsx(W,{variant:"secondary",children:s},t)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No categories suggested."})})]})]}),a.budget_json&&e.jsxs(x,{className:"border-none shadow-lg",children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-purple-600"})," Budget Summary"]})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Venue Estimate:"})," ",e.jsxs("span",{className:"font-medium",children:["$",(E=a.budget_json.venue)==null?void 0:E.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Vendor Estimates:"})," ",e.jsxs("span",{className:"font-medium",children:["$",(_=a.budget_json.vendors)==null?void 0:_.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t pt-2 mt-2",children:[e.jsx("span",{children:"Total Estimate:"})," ",e.jsxs("span",{children:["$",($=a.budget_json.total)==null?void 0:$.toLocaleString()]})]})]})})]}),a.timeline_json&&e.jsxs(x,{className:"border-none shadow-lg",children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-orange-600"})," Suggested Timeline"]})}),e.jsx(u,{className:"space-y-2",children:(T=a.timeline_json.timeline)==null?void 0:T.map((s,t)=>e.jsxs("div",{className:"flex items-start gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full mt-1.5"}),e.jsx("p",{children:s})]},t))})]})]})]})]})})}export{pe as default};
