import{r as c,U as z,ao as u,j as e,y as p,a as U,a2 as B,O as l,I as o,Q as F,W as E,X as I,Y as O,Z as d,T as P,B as D,t as h}from"./index-KrjukJeb.js";import{C as R,a as A,b as L,c as T}from"./card-tLMu1Ov7.js";import{m as q}from"./FloppyDisk.es-BgK92nk8.js";import{R as v}from"./RoleGuard-DRkcvV5M.js";import{P as y}from"./ProviderPortalLayout-D3ZJZ5Ow.js";import"./Envelope.es-BErI3QgS.js";import"./Shield.es-C51nR2_i.js";function H(){const[i,b]=c.useState(null),[f,w]=c.useState(null),[C,N]=c.useState(!0),[m,x]=c.useState(!1),[r,g]=c.useState({name:"",website:"",city:"",country:"",business_license:"",description:""});c.useEffect(()=>{j()},[]);const j=async()=>{try{const s=await z.me();w(s);const t=await u.filter({owner_user_id:s.id,type:"service_provider"});if(t.length>0){const a=t[0];b(a),g({name:a.name||"",website:a.website||"",city:a.city||"",country:a.country||"",business_license:a.business_license||"",description:a.description||""})}}catch(s){console.error("Error fetching organization:",s)}N(!1)},n=(s,t)=>{g(a=>({...a,[s]:t}))},S=async()=>{x(!0);try{i?(await u.update(i.id,r),h.success("Organization updated successfully!")):(await u.create({...r,owner_user_id:f.id,type:"service_provider"}),h.success("Organization created successfully!")),await j()}catch(s){console.error("Error saving organization:",s),h.error("Failed to save organization.")}x(!1)},_=s=>{const t={draft:"bg-gray-100 text-gray-800",submitted:"bg-yellow-100 text-yellow-800",active:"bg-green-100 text-green-800",suspended:"bg-red-100 text-red-800"};return t[s]||t.draft};return C?e.jsx(v,{requiredRole:"service_provider",children:e.jsx(y,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(p,{className:"w-8 h-8 animate-spin text-gray-500"})})})}):e.jsx(v,{requiredRole:"service_provider",children:e.jsx(y,{children:e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Organization Profile"}),e.jsx("p",{className:"text-gray-600",children:"Manage your business details and information"})]}),i&&e.jsx(U,{className:_(i.status),children:i.status.charAt(0).toUpperCase()+i.status.slice(1)})]}),e.jsxs(R,{className:"border-none shadow-lg",children:[e.jsx(A,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-green-600"}),"Business Information"]})}),e.jsxs(T,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",children:"Business Name *"}),e.jsx(o,{id:"name",value:r.name,onChange:s=>n("name",s.target.value),placeholder:"Your service provider business name"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"website",children:"Website"}),e.jsx(o,{id:"website",type:"url",value:r.website,onChange:s=>n("website",s.target.value),placeholder:"https://yourwebsite.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"city",children:"City *"}),e.jsx(o,{id:"city",value:r.city,onChange:s=>n("city",s.target.value),placeholder:"Business city"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"country",children:"Country *"}),e.jsxs(F,{value:r.country,onValueChange:s=>n("country",s),children:[e.jsx(E,{children:e.jsx(I,{placeholder:"Select country"})}),e.jsxs(O,{children:[e.jsx(d,{value:"US",children:"United States"}),e.jsx(d,{value:"CA",children:"Canada"}),e.jsx(d,{value:"UK",children:"United Kingdom"}),e.jsx(d,{value:"AU",children:"Australia"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"business_license",children:"Business License / EIN"}),e.jsx(o,{id:"business_license",value:r.business_license,onChange:s=>n("business_license",s.target.value),placeholder:"Business license number or EIN"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"description",children:"Business Description"}),e.jsx(P,{id:"description",value:r.description,onChange:s=>n("description",s.target.value),placeholder:"Describe your service provider business...",rows:4})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(D,{onClick:S,disabled:m||!r.name||!r.city||!r.country,children:[m?e.jsx(p,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(q,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})]})})})}export{H as default};
