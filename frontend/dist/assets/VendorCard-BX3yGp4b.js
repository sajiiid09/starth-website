import{r as j,j as e,d as _,n as H,a as g,ak as S,al as k,am as P,aj as I,an as R,B as N,U as O,a9 as x,aa as F,ab as E,e as V,ad as U,R as y}from"./index-KrjukJeb.js";import{C as A,c as L}from"./card-tLMu1Ov7.js";import{n as M}from"./ArrowSquareOut.es-DnFjawrD.js";import{s as D}from"./ChatCircle.es-DeE-r4hZ.js";import{n as b}from"./Star.es-BgtEy1eT.js";const $=({venue:s})=>{const[p,n]=j.useState([]),[m,c]=j.useState(!0);if(j.useEffect(()=>{const d=async()=>{var r;c(!0);let o=[s.image_url,s.photo_url,s.hero_photo_url,...s.photos||[],...s.gallery_urls||[]].filter(t=>t&&typeof t=="string"&&t.startsWith("http")).filter(t=>!t.includes("unsplash.com")&&!t.includes("pexels.com")&&!t.includes("pixabay.com"));if(o.length===0&&s.name){console.log(`ðŸ” FORCING Google Photos fetch for: ${s.name}`);try{const t=s.location||`${s.city}, ${s.state}`||s.city;console.log(`   Searching: ${s.name} in ${t}`);const a=await U({place_id:s.google_place_id||null,name:s.name,location:t});console.log("âœ… Raw result:",a),console.log(`   Type: ${typeof a}`),console.log("   Keys:",Object.keys(a||{}));let i=null;(r=a==null?void 0:a.data)!=null&&r.photos?(i=a.data.photos,console.log("   Found via result.data.photos")):a!=null&&a.photos?(i=a.photos,console.log("   Found via result.photos")):Array.isArray(a)&&(i=a,console.log("   Found via direct array")),i&&i.length>0?(console.log(`ðŸ“¸ SUCCESS: Found ${i.length} photos for ${s.name}`),console.log(`   First photo: ${i[0]}`),o=i):(console.error(`âŒ ZERO PHOTOS for ${s.name}`),console.error("   Full response:",JSON.stringify(a,null,2)))}catch(t){console.error(`âŒ FETCH ERROR for ${s.name}:`,t),console.error(`   Message: ${t.message}`),console.error(`   Stack: ${t.stack}`)}}n(o),c(!1)};s!=null&&s.name&&d()},[s]),m)return e.jsx("div",{className:"h-48 w-full bg-gray-200 animate-pulse rounded-t-lg"});const l=p;return l.length===0?e.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-white text-2xl font-bold mb-2",children:s.name}),e.jsxs("div",{className:"text-white/80 text-sm",children:[s.city,", ",s.state]})]})}):l.length===1?e.jsx("div",{className:"w-full h-48 bg-gray-100",children:e.jsx("img",{src:l[0],alt:s.name,className:"w-full h-full object-cover",loading:"eager"})}):e.jsxs("div",{className:"grid grid-cols-4 grid-rows-2 gap-1 h-48 bg-gray-100",children:[e.jsx("div",{className:"col-span-2 row-span-2",children:e.jsx("img",{src:l[0],alt:`${s.name} - Main`,className:"w-full h-full object-cover",loading:"eager"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("img",{src:l[1]||l[0],alt:`${s.name} - View 2`,className:"w-full h-full object-cover",loading:"eager"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 col-span-2",children:[e.jsx("img",{src:l[2]||l[0],alt:`${s.name} - View 3`,className:"w-full h-full object-cover",loading:"eager"}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:l[3]||l[0],alt:`${s.name} - View 4`,className:"w-full h-full object-cover",loading:"eager"}),l.length>4&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:e.jsxs("span",{className:"text-white font-semibold text-sm",children:["+",l.length-4," more"]})})]})]})]})};function Q({venue:s,onRequestQuote:p}){var l,d,h,f,o;const[n,m]=j.useState(!1),c=async()=>{try{const r=await O.me(),t=await x.filter({user_id:r.id});let a=null;for(const u of t)if((await x.filter({conversation_id:u.conversation_id})).some(v=>v.user_id===s.owner_id&&v.user_id!==r.id)){a=u.conversation_id;break}let i=a;i||(i=(await F.create({})).id,await x.create({conversation_id:i,user_id:r.id}),await x.create({conversation_id:i,user_id:s.owner_id||"default_venue_owner"}),await E.create({conversation_id:i,sender_id:r.id,text:`Hi! I found ${s.name} through the AI planner and I'm interested in booking it for my event. Could you please provide more details about availability and pricing?`})),window.location.href=V("Messages")}catch(r){console.error("Error creating message:",r),r.message.includes("Unauthorized")&&(window.location.href="/login")}};return e.jsxs(e.Fragment,{children:[e.jsxs(A,{className:"overflow-hidden hover:shadow-lg transition-all cursor-pointer group",onClick:()=>m(!0),children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{venue:s}),e.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1 flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-xs font-medium text-gray-900",children:s.rating})]})]}),e.jsxs(L,{className:"p-4",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 mb-2",children:s.name}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsx("span",{children:s.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsxs("span",{children:["Capacity: ",s.capacity," guests"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[(l=s.amenities)==null?void 0:l.slice(0,3).map((r,t)=>e.jsx(g,{variant:"outline",className:"text-xs",children:r},t)),((d=s.amenities)==null?void 0:d.length)>3&&e.jsxs(g,{variant:"outline",className:"text-xs",children:["+",s.amenities.length-3," more"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-green-600 font-semibold text-lg",children:["$",(h=s.price)==null?void 0:h.toLocaleString()]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Base rate"})]})]})]}),e.jsx(S,{open:n,onOpenChange:m,children:e.jsxs(k,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(P,{children:e.jsx("div",{className:"relative",children:e.jsx("button",{onClick:()=>m(!1),className:"absolute -top-2 -right-2 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:e.jsx(I,{className:"w-4 h-4"})})})}),e.jsx("div",{className:"relative h-64 w-full rounded-lg overflow-hidden -mt-6 bg-gray-100",children:e.jsx($,{venue:s})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"font-medium",children:s.rating})]}),e.jsxs(g,{className:"bg-blue-100 text-blue-800",children:["Capacity: ",s.capacity]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Location & Contact"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:s.location})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(f=s.amenities)==null?void 0:f.map((r,t)=>e.jsx(g,{variant:"secondary",className:"text-xs",children:r},t))})]}),s.description&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"About This Venue"}),e.jsx("p",{className:"text-gray-700",children:s.description})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Base Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",(o=s.price)==null?void 0:o.toLocaleString()]})]})})}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(N,{onClick:c,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Message ",s.name," Admin"]}),s.website&&e.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"flex-1",children:e.jsxs(N,{variant:"outline",className:"w-full",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Visit Website"]})})]})]})})]})}function J({vendor:s}){var d,h,f;const[p,n]=j.useState(!1),c={catering:"bg-orange-100 text-orange-800","audio/visual":"bg-blue-100 text-blue-800",photography:"bg-purple-100 text-purple-800","event staffing":"bg-green-100 text-green-800",decor:"bg-pink-100 text-pink-800",floral:"bg-rose-100 text-rose-800",av_tech:"bg-blue-100 text-blue-800",entertainment:"bg-yellow-100 text-yellow-800"}[(d=s.category)==null?void 0:d.toLowerCase()]||"bg-gray-100 text-gray-800",l=async()=>{try{const o=await O.me(),r=await x.filter({user_id:o.id});let t=null;for(const i of r)if((await x.filter({conversation_id:i.conversation_id})).some(w=>w.user_id===s.provider_id&&w.user_id!==o.id)){t=i.conversation_id;break}let a=t;a||(a=(await F.create({})).id,await x.create({conversation_id:a,user_id:o.id}),await x.create({conversation_id:a,user_id:s.provider_id||"default_provider"}),await E.create({conversation_id:a,sender_id:o.id,text:`Hi! I found your ${s.category} services through the AI planner and I'm interested in learning more for my upcoming event. Could you please provide details about your offerings and pricing?`})),window.location.href=V("Messages")}catch(o){console.error("Error creating message:",o),o.message.includes("Unauthorized")&&(window.location.href="/login")}};return e.jsxs(e.Fragment,{children:[e.jsxs(A,{className:"overflow-hidden hover:shadow-lg transition-all cursor-pointer group",onClick:()=>n(!0),children:[e.jsxs("div",{className:"relative",children:[e.jsx(C,{vendor:s})," ",e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx(g,{className:`${c} font-medium`,children:s.category})}),e.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1 flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-xs font-medium text-gray-900",children:s.rating})]})]}),e.jsxs(L,{className:"p-4",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:s.service}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 mb-4",children:[e.jsx(g,{variant:"outline",className:"text-xs",children:"Professional Service"}),e.jsx(g,{variant:"outline",className:"text-xs",children:"Insured"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-green-600 font-semibold text-lg",children:["$",(h=s.price)==null?void 0:h.toLocaleString()]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Starting from"})]})]})]}),e.jsx(S,{open:p,onOpenChange:n,children:e.jsxs(k,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(P,{children:e.jsx("button",{onClick:()=>n(!1),className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:e.jsx(I,{className:"w-4 h-4 text-gray-500"})})}),e.jsx("div",{className:"relative h-64 w-full rounded-lg overflow-hidden bg-gray-100",children:e.jsx(C,{vendor:s})}),e.jsxs("div",{className:"space-y-2 p-4 pt-0",children:[e.jsx(R,{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:c,children:s.category}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"font-medium",children:s.rating})]})]})]}),e.jsxs("div",{className:"space-y-3 p-4 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Services Offered"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:s.service}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Starting Price: "}),e.jsxs("span",{className:"text-green-600",children:["$",(f=s.price)==null?void 0:f.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Rating: "}),e.jsxs("span",{children:[s.rating,"/5.0"]})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 p-4 pt-0",children:[e.jsxs(N,{onClick:l,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Message Vendor Admin"]}),s.website&&e.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"flex-1",children:e.jsxs(N,{variant:"outline",className:"w-full",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Visit Website"]})})]})]})})]})}const C=({vendor:s})=>{const[p,n]=y.useState([]),[m,c]=y.useState(!0);if(y.useEffect(()=>{const d=async()=>{var r;c(!0);let o=[s.image_url,s.photo_url,...s.photos||[],...s.portfolio_photos||[]].filter(t=>t&&typeof t=="string"&&t.startsWith("http")).filter(t=>!t.includes("unsplash.com")&&!t.includes("pexels.com")&&!t.includes("pixabay.com"));if(o.length===0&&s.name){console.log(`ðŸ” FORCING Google Photos fetch for: ${s.name}`);try{const t=s.location||(s.city&&s.state?`${s.city}, ${s.state}`:null);console.log(`   Searching: ${s.name} in ${t||"unknown"}`);const a=await U({place_id:s.google_place_id||null,name:s.name,location:t});console.log("âœ… Raw result:",a),console.log(`   Type: ${typeof a}`),console.log("   Keys:",Object.keys(a||{}));let i=null;(r=a==null?void 0:a.data)!=null&&r.photos?(i=a.data.photos,console.log("   Found via result.data.photos")):a!=null&&a.photos?(i=a.photos,console.log("   Found via result.photos")):Array.isArray(a)&&(i=a,console.log("   Found via direct array")),i&&i.length>0?(console.log(`ðŸ“¸ SUCCESS: Found ${i.length} photos for ${s.name}`),console.log(`   First photo: ${i[0]}`),o=i):(console.error(`âŒ ZERO PHOTOS for ${s.name}`),console.error("   Full response:",JSON.stringify(a,null,2)))}catch(t){console.error(`âŒ FETCH ERROR for ${s.name}:`,t),console.error(`   Message: ${t.message}`)}}n(o),c(!1)};s!=null&&s.name?d():(n([]),c(!1))},[s]),m)return e.jsx("div",{className:"h-48 w-full bg-gray-200 animate-pulse rounded-t-lg"});const l=p;return l.length===0?e.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-white text-2xl font-bold mb-2",children:s.name}),e.jsx("div",{className:"text-white/80 text-sm",children:s.category})]})}):l.length===1?e.jsx("div",{className:"w-full h-48 bg-gray-100",children:e.jsx("img",{src:l[0],alt:s.name,className:"w-full h-full object-cover",loading:"eager"})}):e.jsxs("div",{className:"grid grid-cols-4 grid-rows-2 gap-1 h-48 bg-gray-100",children:[e.jsx("div",{className:"col-span-2 row-span-2",children:e.jsx("img",{src:l[0],alt:`${s.name} - Main`,className:"w-full h-full object-cover",loading:"eager"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("img",{src:l[1]||l[0],alt:`${s.name} - Work 2`,className:"w-full h-full object-cover",loading:"eager"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 col-span-2",children:[e.jsx("img",{src:l[2]||l[0],alt:`${s.name} - Work 3`,className:"w-full h-full object-cover",loading:"eager"}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:l[3]||l[0],alt:`${s.name} - Work 4`,className:"w-full h-full object-cover",loading:"eager"}),l.length>4&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:e.jsxs("span",{className:"text-white font-semibold text-sm",children:["+",l.length-4," more"]})})]})]})]})};export{Q as V,J as a};
