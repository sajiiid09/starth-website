import{r as n,U as y,ao as B,j as e,y as p,ay as J,O as a,B as j,I as c,az as Q,Q as Z,W as K,X as ee,Y as se,Z as N,t as l,A as ae}from"./index-KrjukJeb.js";import{C as b,a as k,b as w,c as C}from"./card-tLMu1Ov7.js";import{S as f}from"./switch-HwOEIoQi.js";import{A as te,a as ie,b as re}from"./avatar-tkolttA6.js";import{s as ne}from"./Bell.es-BSDYVN2Y.js";import{n as le}from"./Camera.es-CbxhcNz5.js";import{m as S}from"./FloppyDisk.es-BgK92nk8.js";import{R as T}from"./RoleGuard-DRkcvV5M.js";import{V}from"./VenuePortalLayout-DFmbwPeC.js";import"./Envelope.es-BErI3QgS.js";import"./Shield.es-C51nR2_i.js";function ve(){var I,M,R,z;const[oe,D]=n.useState(null),[F,L]=n.useState(null),[G,O]=n.useState(!0),[d,m]=n.useState(!1),[_,P]=n.useState(!1),[i,v]=n.useState({full_name:"",phone:"",email:"",profile_picture_url:""}),[h,U]=n.useState({email_bookings:!0,email_messages:!0,email_marketing:!1,sms_bookings:!1,sms_reminders:!0}),[o,E]=n.useState({payout_email:"",payout_method:"bank_transfer",bank_account:"",routing_number:"",tax_id:""});n.useEffect(()=>{A()},[]);const A=async()=>{try{const s=await y.me();D(s),v({full_name:s.full_name||"",phone:s.phone||"",email:s.email||"",profile_picture_url:s.profile_picture_url||""}),U({...{email_bookings:!0,email_messages:!0,email_marketing:!1,sms_bookings:!1,sms_reminders:!0},...s.notification_preferences||{}});const t=await B.filter({owner_user_id:s.id,type:"venue_owner"});if(t.length>0){const g=t[0];L(g),g.payout_settings&&E($=>({...$,...g.payout_settings}))}}catch(s){console.error("Error fetching settings:",s)}O(!1)},q=async s=>{const r=s.target.files[0];if(r){if(r.size>5*1024*1024){l.error("File size must be less than 5MB");return}P(!0);try{const{file_url:t}=await ae({file:r});v(g=>({...g,profile_picture_url:t})),l.success("Profile picture uploaded!")}catch(t){console.error("Error uploading image:",t),l.error("Failed to upload image")}P(!1)}},X=(s,r)=>{v(t=>({...t,[s]:r}))},u=(s,r)=>{U(t=>({...t,[s]:r}))},x=(s,r)=>{E(t=>({...t,[s]:r}))},H=async()=>{m(!0);try{await y.updateMyUserData({full_name:i.full_name,phone:i.phone,profile_picture_url:i.profile_picture_url}),window.dispatchEvent(new CustomEvent("userProfileUpdated",{detail:{full_name:i.full_name,profile_picture_url:i.profile_picture_url}})),l.success("Profile saved successfully!"),await A()}catch(s){console.error("Error saving user settings:",s),l.error("Failed to save profile.")}m(!1)},W=async()=>{m(!0);try{await y.updateMyUserData({notification_preferences:h}),l.success("Notification preferences saved!")}catch(s){console.error("Error saving notifications:",s),l.error("Failed to save notification preferences.")}m(!1)},Y=async()=>{m(!0);try{F&&(await B.update(F.id,{payout_settings:o}),l.success("Payout settings saved!"))}catch(s){console.error("Error saving payout settings:",s),l.error("Failed to save payout settings.")}m(!1)};return G?e.jsx(T,{requiredRole:"venue_owner",children:e.jsx(V,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(p,{className:"w-8 h-8 animate-spin text-gray-500"})})})}):e.jsx(T,{requiredRole:"venue_owner",children:e.jsx(V,{children:e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Account Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your account preferences and settings"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{className:"border-none shadow-lg",children:[e.jsx(k,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-blue-600"}),"Profile Information"]})}),e.jsxs(C,{className:"space-y-6",children:[" ",e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs(te,{className:"w-24 h-24",children:[e.jsx(ie,{src:i.profile_picture_url}),e.jsx(re,{className:"text-xl",children:((M=(I=i.full_name)==null?void 0:I[0])==null?void 0:M.toUpperCase())||((z=(R=i.email)==null?void 0:R[0])==null?void 0:z.toUpperCase())||"U"})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"profile_picture",className:"cursor-pointer",children:e.jsx(j,{variant:"outline",disabled:_,asChild:!0,children:e.jsx("span",{children:_?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Change Photo"]})})})}),e.jsx("input",{id:"profile_picture",type:"file",accept:"image/*",onChange:q,className:"hidden"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG up to 5MB"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"full_name",children:"Full Name"}),e.jsx(c,{id:"full_name",value:i.full_name,onChange:s=>X("full_name",s.target.value),placeholder:"Your full name"})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"phone",children:"Phone Number"}),e.jsx(c,{id:"phone",value:i.phone,onChange:s=>X("phone",s.target.value),placeholder:"+1 (555) 123-4567"})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"email",children:"Email Address"}),e.jsx(c,{id:"email",value:i.email,disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{onClick:H,disabled:d||_,children:[" ",d?e.jsx(p,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(S,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})]})]}),e.jsxs(b,{className:"border-none shadow-lg",children:[e.jsx(k,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 text-yellow-600"}),"Notification Preferences"]})}),e.jsxs(C,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Email Notifications"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"email_bookings",children:"Booking Updates"}),e.jsx("p",{className:"text-xs text-gray-500",children:"New bookings, cancellations, and changes"})]}),e.jsx(f,{id:"email_bookings",checked:h.email_bookings,onCheckedChange:s=>u("email_bookings",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"email_messages",children:"Messages"}),e.jsx("p",{className:"text-xs text-gray-500",children:"New messages from organizers"})]}),e.jsx(f,{id:"email_messages",checked:h.email_messages,onCheckedChange:s=>u("email_messages",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"email_marketing",children:"Marketing Updates"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Platform updates and tips"})]}),e.jsx(f,{id:"email_marketing",checked:h.email_marketing,onCheckedChange:s=>u("email_marketing",s)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"SMS Notifications"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"sms_bookings",children:"Urgent Bookings"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Last-minute bookings and cancellations"})]}),e.jsx(f,{id:"sms_bookings",checked:h.sms_bookings,onCheckedChange:s=>u("sms_bookings",s)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"sms_reminders",children:"Event Reminders"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Reminders for upcoming events"})]}),e.jsx(f,{id:"sms_reminders",checked:h.sms_reminders,onCheckedChange:s=>u("sms_reminders",s)})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{onClick:W,disabled:d,children:[d?e.jsx(p,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(S,{className:"w-4 h-4 mr-2"}),"Save Notifications"]})})]})]}),e.jsxs(b,{className:"border-none shadow-lg",children:[e.jsx(k,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5 text-green-600"}),"Payout Settings"]})}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"payout_email",children:"Payout Email"}),e.jsx(c,{id:"payout_email",type:"email",value:o.payout_email,onChange:s=>x("payout_email",s.target.value),placeholder:"payments@yourvenue.com"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email for payout notifications"})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"payout_method",children:"Payout Method"}),e.jsxs(Z,{value:o.payout_method,onValueChange:s=>x("payout_method",s),children:[e.jsx(K,{children:e.jsx(ee,{})}),e.jsxs(se,{children:[e.jsx(N,{value:"bank_transfer",children:"Bank Transfer (ACH)"}),e.jsx(N,{value:"wire_transfer",children:"Wire Transfer"}),e.jsx(N,{value:"check",children:"Paper Check"})]})]})]}),o.payout_method==="bank_transfer"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"routing_number",children:"Routing Number"}),e.jsx(c,{id:"routing_number",value:o.routing_number,onChange:s=>x("routing_number",s.target.value),placeholder:"123456789"})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"bank_account",children:"Account Number"}),e.jsx(c,{id:"bank_account",type:"password",value:o.bank_account,onChange:s=>x("bank_account",s.target.value),placeholder:"Account number"})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"tax_id",children:"Tax ID / EIN"}),e.jsx(c,{id:"tax_id",value:o.tax_id,onChange:s=>x("tax_id",s.target.value),placeholder:"XX-XXXXXXX"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{onClick:Y,disabled:d,children:[d?e.jsx(p,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(S,{className:"w-4 h-4 mr-2"}),"Save Payout Info"]})})]})]})]})]})})})}export{ve as default};
